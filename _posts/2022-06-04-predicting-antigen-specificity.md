---
layout: post
title:  "TCR BERT"
date:   2022-06-04 22:10:01 +0800
categories: [Paper]
tag: 
  - Deep Learning
  - 生物信息
---

> 笔记

用于单细胞 TCR 分析实验的 α 链和 β 链、抗原和协变量的联合深度学习模型 

根据 TCR α 和 b 链序列以及其他细胞协变量 (如`供体身份`和`细胞表面蛋白计数`) 预测单个 T 细胞的抗原特异性。我们使用了一个公开的单细胞数据集（10x Genomics，2019），该数据集基于一种技术，其中细胞被捕获在微流体系统中的液滴中，因此可以对每个捕获的细胞的抗原特异性、CDR3 TCR序列、表面蛋白丰度和 mRNA 丰度进行分析。抗原特异性通过与抗原特异性右旋糖酐 (pMHC复合物) 条形码序列相关的独特分子标识符计数进行量化 (10x Genomics，2019)。此外，我们使用数据库 (IEDB；Shugay et al，2018；Vita et al，2019) 和 VDJdb (Shugay et al，2018)，其中包含来自传统低吞吐量筛查和晶体结构的额外结合 TCR 和抗原序列对，以验证我们的结果。以前曾尝试在较小的数据集上预测抗原特异性，但新的单细胞技术能够收集到的数据集比之前通过整合 TCR 特异性整个领域的研究而获得的数据集大几个数量级（Shugay et al，2018；Vita et al，2019）。然而，这些大型单细胞数据集可能比批量或单独验证的研究结果更容易受到噪声的影响。我们为预测任务选择了深度学习模型，因为这些模型非常适合处理大型噪声数据集。我们将可解释的线性模型和之前提出的非线性参考模型 (NetTCR；预印本：Jurtz et al，2018) 作为基线方法。这里使用的卷积模型和线性模型在结构上类似于将抗原特异性与 TCR 序列簇相关的模型，但它们是连续可微的，因此更容易扩展到新的特异性组。 

从TCR序列和数值细胞协变量预测抗原特异性是一个混合输入数据类型的问题。在特异性评估的背景下，通过mRNA或表面蛋白丰度等方式对单细胞进行深入表征，使得这种混合输入数据类型模型与单细胞数据的相关性比之前与文献中描述的结合TCR和抗原对的相关性差得多。我们通过将为数值数据量身定制的网络与为序列结构数据量身定制的网络相结合来解决这个问题，从而产生一个单一的预测（图1B）。序列数据的机器学习是一个正在进行的研究领域，不同的层类型对于不同的任务是有效的。因此，我们实现了所有主要的序列数据特定层类型，以便能够对深度学习体系结构进行全面比较，以预测TCR特异性。据我们所知，这种全面的比较是同类比较中的第一次。具体而言，我们实施了重复层（双向GRUs；Schuster&Paliwal，1997；Cho et al，2014）和双向LSTM（Hochreiter&Schmidhuber，1997；Schuster&Paliwal，1997），卷积层（Szegedy et al，2015），自我注意层（Vaswani et al，2 0 1 7），以及密集连接的网络，其中包括与先前工作相关的线性模型（Glanville et al，2017）。所有这些序列数据嵌入层类型都需要序列元素的初始表示：氨基酸的初始编码。我们比较了分类、替换频率衍生（BLOSUM）和学习嵌入，发现初始氨基酸嵌入对结果没有明显影响（附录图S1）。我们在这里提出的新的学习嵌入比标准嵌入层（方法和协议）能够向序列嵌入层暴露低维氨基酸空间，因此参数效率更高。在下文中，我们仅展示基于BLOSUM50（方法和协议）的学习的1×1卷积嵌入的模型拟合。

将任意抗原上的结合事件预测视为一种独特的场景，需要模型嵌入输入抗原序列 (抗原嵌入模型)

抗原嵌入模型基于正负集的概念。在单细胞数据中，未结合任何 pMHC 物种或给定 pMHC 物种的细胞视为负集。正集被定义为检测到的结合对。我们从 IEDB 或VDJdb中生成TCR-抗原结合对的负数集

我们对数据集进行了子集划分，以便进行有意义的模型比较和预测性评估：单细胞数据集包含来自四个供体的150000多个细胞，这些细胞成功地重建了TCR序列，并测量了与44个不同pMHC复合物的结合特异性。

细胞特异性协变量改善结合事件预测 

无协变量的双向 GRU 模型（基于序列的最佳模型）的受试者操作特征曲线下的平均面积（AUC ROC、方法和方案）为 0.33，有供体协变量的受试者操作特征曲线下的平均面积为0.81（图 1C）。 

总体表现最好的模型包括供体、总计数、阴性对照计数和表面蛋白计数，AUC ROC为 0.87

具有最多协变量的最佳模型几乎能正确预测所有观测值，而具有较少协变量的模型也能正确预测所有观测值

α 链和 β 链的联合建模改进了绑定事件预测 

TRA + TRB 模型略优于仅 TRA 和仅 TRB 模型

T 细胞上结合的 pMHC 的数量由单个 TCR 对 pMHC 单体的亲和力和细胞表面多聚 pMHC 复合物和 TCR 单体之间可能的相互作用数量（化合物结合强度）的组合决定。

序列空间嵌入抗原的模型优于分类模型

与序列嵌入模型相比，在 IEDB（分类模型在 11 种抗原中有 8 种具有较高的 AUC ROC，Wilcoxon 检验，P < 0.01）和单细胞 pMHC CD8 + T 细胞数据集上（分类模型在 8 种抗原中有 8 种具有较高的 AUC ROC，Wilcoxon 检验，P < 0.01；图 3D和 E），抗原智能分类模型对其训练的抗原具有更好的预测性能。